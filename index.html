<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All-in-One File Tool</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.18.0/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/6.0.0/fabric.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.10.200/pdf.min.js"></script>
<style>
    body { font-family: 'Roboto', sans-serif; background: #f0f4f8; margin:0; padding:0; }
    header { background: #4f46e5; color: white; text-align: center; padding: 20px; font-size: 2em; font-weight: 700; }
    .container { max-width: 1200px; margin: 30px auto; display: grid; gap: 30px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); padding: 0 20px; }
    .card { background: white; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); padding: 20px; text-align: center; transition: transform 0.3s, box-shadow 0.3s; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 15px 25px rgba(0,0,0,0.15); }
    .card h2 { color: #4f46e5; margin-bottom: 15px; }
    .card input[type="file"], .card button, .card input[type="text"] { margin: 10px 0; }
    .card button { background: #4f46e5; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 500; transition: background 0.3s; }
    .card button:hover { background: #3730a3; }
    footer { text-align: center; padding: 20px; color: #777; }
    canvas { border:1px solid #ccc; margin-top:10px; }
</style>
</head>
<body>

<header>All-in-One File Tool</header>

<div class="container">
    <!-- Image to PDF -->
    <div class="card">
        <h2>Image → PDF</h2>
        <input type="file" id="imgToPdf" accept="image/*" multiple>
        <br>
        <button onclick="convertImageToPDF()">Convert</button>
    </div>

    <!-- Sign PDF -->
    <div class="card">
        <h2>Sign PDF</h2>
        <input type="file" id="signPdf" accept="application/pdf">
        <br>
        <input type="text" id="signText" placeholder="Type your signature">
        <br>
        <button onclick="signPDF()">Sign PDF</button>
    </div>

    <!-- Image Text Editor -->
    <div class="card">
        <h2>Image Text Editor</h2>
        <input type="file" id="imgEditor" accept="image/*">
        <br>
        <button onclick="loadImageEditor()">Load Image</button>
        <br>
        <canvas id="canvas" width="300" height="300"></canvas>
        <br>
        <button onclick="addText()">Add Text</button>
        <button onclick="downloadImage()">Download</button>
    </div>

    <!-- PDF → Excel -->
    <div class="card">
        <h2>PDF → Excel</h2>
        <input type="file" id="pdfToExcel" accept="application/pdf">
        <br>
        <button onclick="convertPDFtoExcel()">Convert</button>
    </div>
</div>

<footer>© 2025 MONU MEENA</footer>

<script>
/* -------- Image to PDF -------- */
async function convertImageToPDF() {
    const input = document.getElementById('imgToPdf');
    if(!input.files.length) return alert("Select image(s)");
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF();
    for(let i=0;i<input.files.length;i++){
        const img = input.files[i];
        const data = await new Promise(resolve=>{
            const reader = new FileReader();
            reader.onload = e=>resolve(e.target.result);
            reader.readAsDataURL(img);
        });
        if(i>0) pdf.addPage();
        pdf.addImage(data,'JPEG',10,10,180,160);
    }
    pdf.save('images.pdf');
}

/* -------- Sign PDF -------- */
async function signPDF() {
    const fileInput = document.getElementById('signPdf');
    const text = document.getElementById('signText').value;
    if(!fileInput.files.length) return alert("Select PDF");
    const file = await fileInput.files[0].arrayBuffer();
    const pdfDoc = await PDFLib.PDFDocument.load(file);
    const pages = pdfDoc.getPages();
    const firstPage = pages[0];
    firstPage.drawText(text, { x:50, y:50, size:30, color: PDFLib.rgb(0,0,1)});
    const pdfBytes = await pdfDoc.save();
    const blob = new Blob([pdfBytes], {type:'application/pdf'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='signed.pdf'; a.click();
}

/* -------- Image Text Editor -------- */
let canvasObj = new fabric.Canvas('canvas');
function loadImageEditor() {
    const fileInput = document.getElementById('imgEditor');
    if(!fileInput.files.length) return alert("Select image");
    const reader = new FileReader();
    reader.onload = function(e) {
        fabric.Image.fromURL(e.target.result, function(img){
            canvasObj.clear();
            img.set({ left:0, top:0, scaleX:300/img.width, scaleY:300/img.height });
            canvasObj.add(img);
        });
    }
    reader.readAsDataURL(fileInput.files[0]);
}
function addText() {
    const text = prompt("Enter text");
    if(text) {
        const t = new fabric.Text(text,{ left:50, top:50, fill:'#4f46e5', fontSize:20 });
        canvasObj.add(t);
    }
}
function downloadImage() {
    const data = canvasObj.toDataURL({format:'png'});
    const a = document.createElement('a'); a.href=data; a.download='edited.png'; a.click();
}

/* -------- PDF to Excel -------- */
async function convertPDFtoExcel() {
    const input = document.getElementById('pdfToExcel');
    if(!input.files.length) return alert("Select PDF");
    const file = input.files[0];
    const arrayBuffer = await file.arrayBuffer();
    const pdf = await pdfjsLib.getDocument({data:arrayBuffer}).promise;
    let textArr = [];
    for(let i=1;i<=pdf.numPages;i++){
        const page = await pdf.getPage(i);
        const content = await page.getTextContent();
        const strings = content.items.map(item=>item.str);
        textArr.push(strings);
    }
    const ws = XLSX.utils.aoa_to_sheet(textArr.flat());
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
    XLSX.writeFile(wb, "converted.xlsx");
}
</script>

</body>
</html>
